<?xml version="1.0"?>
<project name="crazyfm-ext-starlingApp" basedir="." default="package">
	
	<!-- set up a prefix for all environment variables -->
	<property environment="env."/>
	<!-- System environment must contain FLEX_HOME variable that points to Flex SDK -->
	<property name="FLEX_HOME" location="${env.FLEX_HOME}"/>

	<taskdef resource="flexTasks.tasks" classpath="${FLEX_HOME}/ant/lib/flexTasks.jar" />

	<!-- identify properties file -->
    <property file="build.properties"/>

    <target name="package" depends="clean,swc,asdoc"/>
    <target name="asdoc">
        <echo>-----------------------------------</echo>
        <echo>[asdoc] Generating starlingApp extension ASDOC documentation...</echo>
        <echo>-----------------------------------</echo>
        <delete dir="${doc}"/>
        <mkdir dir="${doc}"/>
        <asdoc output="${doc}" dir="${FLEX_HOME}" lenient="true" failonerror="true">
            <doc-sources path-element="${src}"/>
            <external-library-path dir="${crazyfm-core}" includes="*"/>
            <external-library-path dir="${starling}" includes="*"/>
            <external-library-path dir="${as3-signals}" includes="*"/>
        </asdoc>
    </target>
    <target name="swc">
        <echo>-----------------------------------</echo>
        <echo>[swc] Building starlingApp extension SWC...</echo>
        <echo>-----------------------------------</echo>
        <compc output="${swc}/cfm-ext-starlingApp-${ver.num}.swc">
            <load-config filename="${FLEX_HOME}/frameworks/flex-config.xml"/>
            <include-sources dir="${src}" includes="*"/>
            <external-library-path dir="${crazyfm-core}" includes="*"/>
            <external-library-path dir="${starling}" includes="*"/>
            <external-library-path dir="${as3-signals}" includes="*"/>
            <external-library-path dir="${FLEX_HOME}/frameworks/libs/player/20.0" includes="*"/>
        </compc>
    </target>
    <target name="clean">
        <echo>-----------------------------------</echo>
        <echo>[clean] Cleaning build directory....</echo>
        <echo>-----------------------------------</echo>
        <delete dir="${out}"/>
    </target>
    <target name="build_to_root" depends="swc">
        <echo>-----------------------------------</echo>
        <echo>[build_to_root] Building to root...</echo>
        <echo>-----------------------------------</echo>
        <copy file="${swc}/cfm-ext-starlingApp-${ver.num}.swc" todir="../../out"/>
    </target>
</project>
